<<<<<<< Updated upstream
filter(anno==2019)
ganadores_mun<-  ganadores_mun|>
mutate("Tipo_mun"= if_else(censo>median(ganadores_mun$censo),"Urbana","Rural"))
ggplot(ganadores_mun)+
geom_bar(aes(x = siglas, fill = siglas))+
scale_fill_manual(values = colores_partidos)+
facet_wrap(~Tipo_mun)+
labs(title = "GANADORES RURALES Y URBANOS 2019",
x= "PARTIDOS",
y= "VICTORIAS")+
theme_minimal()+
theme(
legend.position = "none",  # Quitar la leyenda
strip.text = element_text(face = "bold", size = 12),  # Estilo de los títulos de las facetas
plot.title = element_text(face = "bold", size = 12, hjust = 0.5),  # Estilo del título
plot.subtitle = element_text(size = 12, hjust = 0.5), # Estilo del subtítulo
axis.text = element_text(size = 10, angle = 30)
)+
guides(alpha = "none")
mutate("key"=glue("{codigo_provincia}-{codigo_municipio}")) |>
group_by(key) |>
drop_na(votos) |>
slice_max(votos)
View(election_tidy_with_siglas)
ganadores_mun<-election_tidy_with_siglas |>
filter(anno==2019)
mutate("key"=glue("{codigo_provincia}-{codigo_municipio}")) |>
group_by(key) |>
drop_na(votos) |>
slice_max(votos)
ganadores_mun<-election_tidy_with_siglas |>
filter(anno==2019)
ganadores_mun<-election_tidy_with_siglas |>
filter(anno==2019) |>
mutate("key"=glue("{codigo_provincia}-{codigo_municipio}")) |>
group_by(key) |>
drop_na(votos) |>
slice_max(votos)
ganadores_mun<-  ganadores_mun|>
mutate("Tipo_mun"= if_else(censo>median(ganadores_mun$censo),"Urbana","Rural"))
ganadores_mun<-  ganadores_mun|>
mutate("Tipo_mun"= if_else(censo>median(ganadores_mun$censo),"Urbana","Rural"))
ggplot(ganadores_mun)+
geom_bar(aes(x = siglas, fill = siglas))+
scale_fill_manual(values = colores_partidos)+
facet_wrap(~Tipo_mun)+
labs(title = "GANADORES RURALES Y URBANOS 2019",
x= "PARTIDOS",
y= "VICTORIAS")+
theme_minimal()+
theme(
legend.position = "none",  # Quitar la leyenda
strip.text = element_text(face = "bold", size = 12),  # Estilo de los títulos de las facetas
plot.title = element_text(face = "bold", size = 12, hjust = 0.5),  # Estilo del título
plot.subtitle = element_text(size = 12, hjust = 0.5), # Estilo del subtítulo
axis.text = element_text(size = 10, angle = 30)
)+
guides(alpha = "none")
#Mendoza
#Relación entre el censo y el voto mediante un mapa:
library(patchwork)
indice <- election_data|>
filter(anno==2019) |>
mutate("key"=glue("{codigo_provincia}-{codigo_municipio}")) |>
drop_na(votos_candidaturas, censo) |>
mutate("indice" = votos_candidaturas / censo)
mapa<-mapSpain::esp_get_munic() |>
mutate("key"=glue("{cpro}-{cmun}"))
mapa_indice<- mapa |>
left_join(indice, by="key")
#Grafico de la participacion
g_ind<-ggplot(mapa_indice)+
geom_sf(aes(alpha=indice, fill=indice), color=NA)+
scale_alpha_continuous(range = c(0.7,0.9))+
scale_fill_gradient2(low = "#b9feff",mid="#00c9ff", high = "#040b64", midpoint =
mean(indice$indice), labels = scales::label_number(scale = 100, suffix="%"))+
labs(fill="PARTICIPACION",
title = "PARTICIPACION 2019")+
theme_minimal()+
theme(
axis.text = element_blank(),  # Eliminar etiquetas de los ejes
axis.ticks = element_blank(),  # Eliminar marcas de los ejes
legend.position = "bottom",  # Colocar la leyenda abajo
legend.title = element_text(face = "bold", size = 12),  # Estilo de título de la leyenda
legend.text = element_text(size = 8, angle = 30),  # Estilo de texto de la leyenda
strip.text = element_text(face = "bold", size = 12),  # Estilo de los títulos de las facetas
plot.title = element_text(face = "bold", size = 12, hjust = 0.5),  # Estilo del título
plot.subtitle = element_text(size = 12, hjust = 0.5) # Estilo del subtítulo
)+
guides(alpha = "none")
#Grafico del censo de España
g_cen<-ggplot(mapa_indice)+
geom_sf(aes(alpha=censo, fill=censo), color=NA)+
scale_alpha_continuous(range = c(0.7,0.9))+
scale_fill_gradient2(low = "#b9feff",mid="#00c9ff", high = "#040b64", midpoint =
mean(election_data$censo), transform = "log",labels = scales::label_number(scale = 1, accuracy = 1))+
labs(title = "CENSO EN 2019")+
theme_minimal()+
theme(
axis.text = element_blank(),  # Eliminar etiquetas de los ejes
axis.ticks = element_blank(),  # Eliminar marcas de los ejes
legend.position = "bottom",  # Colocar la leyenda abajo
legend.title = element_text(face = "bold", size = 12),  # Estilo de título de la leyenda
legend.text = element_text(size = 8, angle = 30),  # Estilo de texto de la leyenda
strip.text = element_text(face = "bold", size = 12),  # Estilo de los títulos de las facetas
plot.title = element_text(face = "bold", size = 12, hjust = 0.5),  # Estilo del título
plot.subtitle = element_text(size = 12, hjust = 0.5) # Estilo del subtítulo
)+
guides(alpha = "none")
votos_censo<-g_ind+g_cen   #Sumamos las graficas para compararlas
print(votos_censo)
colores_partidos <- c(
"PSOE" = "#E30000",
"PP" = "#0000FF",
"C's" = "#FF6600",
"PNV" = "#006747",
"BNG" = "#0C6F6D",
"CIU" = "#9C3D28",
"UP" = "#6A0DAD",
"ERC" = "#E24D3A",
"EH-BILDU" = "#006F6F",
"MP" = "#00CFFF",
"VOX" = "#008000",
"OTROS" = "#BEBEBE"
=======
)
# Calcular la participación promedio por comunidad autónoma
participacion_media_ccaa <- election_tidy_with_siglas |>
group_by(codigo_ccaa) |>
summarise(
participacion_promedio = mean(votos_candidaturas, na.rm = TRUE) / mean(censo, na.rm = TRUE) * 100
)
# Sustituir el código de la comunidad autónoma por su nombre usando el mapeo
participacion_media_ccaa <- participacion_media_ccaa |>
mutate(nombre_ccaa = codigo_a_comunidad[as.character(codigo_ccaa)])
# Mejorar gráfico con nombres de comunidad autónoma
ggplot(participacion_media_ccaa, aes(x = reorder(nombre_ccaa, -participacion_promedio), y = participacion_promedio, fill = nombre_ccaa)) +
geom_bar(stat = "identity", show.legend = FALSE, width = 0.8) +
geom_text(aes(label = round(participacion_promedio, 2)),
vjust = -0.3,  # Coloca los números a la derecha de las barras
color = "black", size = 4, fontface = "bold") +
scale_fill_viridis_d(option = "D", begin = 0.2, end = 0.8) +  # Colores agradables
scale_y_continuous(limits = c(0, 100)) +  # Ajustar el eje Y de 0 a 100
labs(
title = "Comunidad Autónoma con Mayor Participación Electoral Promedio (2008-2019)",
subtitle = "Participación promedio en las elecciones durante el período 2008-2019",
x = "Comunidad Autónoma",
y = "Participación Promedio (%)"
) +
theme_minimal(base_size = 15) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 13, family = "Arial", color = "darkblue"),
axis.text.y = element_text(size = 13, family = "Arial", color = "darkblue"),
axis.title.x = element_text(size = 14, face = "bold", family = "Arial", color = "darkred"),
axis.title.y = element_text(size = 14, face = "bold", family = "Arial", color = "darkred"),
plot.title = element_text(size = 11, face = "bold", family = "Arial", color = "darkgreen"),
plot.subtitle = element_text(size = 12, family = "Arial", color = "gray50"),
plot.margin = margin(10, 20, 10, 20),
panel.grid.major = element_line(color = "gray85", size = 0.5),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white", color = "white")
)
# Calcular la participación promedio por comunidad autónoma
codigo_a_comunidad <- c(
"14" = "País Vasco",
"07" = "Castilla La Mancha",
"17" = "Comunidad Valenciana",
"01" = "Andalucía",
"08" = "Castilla y León",
"10" = "Extremadura",
"04" = "Islas Baleares",
"09" = "Cataluña",
"11" = "Galicia",
"02" = "Aragón",
"16" = "La Rioja",
"12" = "Madrid",
"15" = "Murcia",
"13" = "Navarra",
"03" = "Asturias",
"05" = "Canarias",
"06" = "Cantabria",
"18" = "Ceuta",
"19" = "Melilla"
)
# Calcular la participación promedio por comunidad autónoma
participacion_media_ccaa <- election_tidy_with_siglas |>
group_by(codigo_ccaa) |>
summarise(
participacion_promedio = mean(votos_candidaturas, na.rm = TRUE) / mean(censo, na.rm = TRUE) * 100
)
# Sustituir el código de la comunidad autónoma por su nombre usando el mapeo
participacion_media_ccaa <- participacion_media_ccaa |>
mutate(nombre_ccaa = codigo_a_comunidad[as.character(codigo_ccaa)])
# Mejorar gráfico con nombres de comunidad autónoma
ggplot(participacion_media_ccaa, aes(x = reorder(nombre_ccaa, -participacion_promedio), y = participacion_promedio, fill = nombre_ccaa)) +
geom_bar(stat = "identity", show.legend = FALSE, width = 0.8) +
geom_text(aes(label = round(participacion_promedio, 2)),
vjust = -0.3,  # Coloca los números a la derecha de las barras
color = "black", size = 3, fontface = "bold") +
scale_fill_viridis_d(option = "D", begin = 0.2, end = 0.8) +  # Colores agradables
scale_y_continuous(limits = c(0, 100)) +  # Ajustar el eje Y de 0 a 100
labs(
title = "Comunidad Autónoma con Mayor Participación Electoral Promedio (2008-2019)",
subtitle = "Participación promedio en las elecciones durante el período 2008-2019",
x = "Comunidad Autónoma",
y = "Participación Promedio (%)"
) +
theme_minimal(base_size = 15) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 13, family = "Arial", color = "darkblue"),
axis.text.y = element_text(size = 13, family = "Arial", color = "darkblue"),
axis.title.x = element_text(size = 14, face = "bold", family = "Arial", color = "darkred"),
axis.title.y = element_text(size = 14, face = "bold", family = "Arial", color = "darkred"),
plot.title = element_text(size = 11, face = "bold", family = "Arial", color = "darkgreen"),
plot.subtitle = element_text(size = 12, family = "Arial", color = "gray50"),
plot.margin = margin(10, 20, 10, 20),
panel.grid.major = element_line(color = "gray85", size = 0.5),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white", color = "white")
)
surveys_clean |>
group_by(type_survey)
surveys_clean <- surveys_tidy |>
mutate(
date_elec = ymd(date_elec),
field_date_from = ymd(field_date_from),
field_date_to = ymd(field_date_to),
field_duration = as.numeric(field_date_to - field_date_from)
)
# Filtrar la base de datos según las condiciones
surveys_clean <- surveys_clean |>
filter(
date_elec >= "2008-01-01",
exit_poll == FALSE,
!is.na(size) & size >= 500,
field_duration > 1
)
encuestas_filtradas <- surveys_clean %>%
filter(size >= 500)
# Graficar la relación entre tamaño de la muestra y la participación electoral
ggplot(encuestas_filtradas, aes(x = size, y = value)) +
geom_point(aes(color = Partido), alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(title = "Relación entre Tamaño de la Muestra y Participación Electoral",
x = "Tamaño de la Muestra", y = "Participación Electoral (%)") +
theme_minimal()
encuestas_filtradas <- surveys_clean %>%
filter(size >= 500)
partidos_colores <- c(
"PSOE" = "#D50032",  # Color del PSOE (rojo)
"PP" = "#0056A0",    # Color del PP (azul)
"C's" = "#FF6600",    # Color de Ciudadanos (naranja)
"VOX" = "#006747",    # Color de VOX (verde)
"UP" = "#9B4F96",     # Color de Unidas Podemos (morado)
"ERC" = "#D82B6D",    # Color de ERC (rojo)
"PNV" = "#006A3E",    # Color del PNV (verde)
"MP" = "#03A9F4",     # Color de Más País (azul claro)
"EH-BILDU" = "#E32B5F",# Color de EH Bildu (rosa)
"CIU" = "#A7C3A4",    # Color de Convergencia i Unió (verde oliva)
"BNG" = "#E60012",    # Color del BNG (rojo)
"Otros" = "#BDBDBD"    # Color para otros partidos (gris)
)
# Graficar la relación entre tamaño de la muestra y participación electoral con los colores de los partidos
ggplot(encuestas_filtradas, aes(x = size, y = value, color = Partido)) +
geom_point(alpha = 0.7, size = 3) +  # Puntos con tamaño aumentado y un poco transparentes
geom_smooth(method = "lm", se = FALSE, color = "black", size = 1) +  # Línea de regresión
scale_color_manual(values = partidos_colores) +  # Asignar los colores a los partidos
labs(title = "Relación entre Tamaño de la Muestra y Participación Electoral",
x = "Tamaño de la Muestra", y = "Participación Electoral (%)") +
theme_minimal(base_size = 14) +  # Tema minimalista y tamaño de fuente ajustado
theme(
legend.position = "bottom",  # Posición de la leyenda
legend.title = element_blank(),  # No mostrar título de la leyenda
axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Ángulo y tamaño de las etiquetas del eje X
axis.text.y = element_text(size = 12),  # Tamaño de las etiquetas del eje Y
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Título en negrita y centrado
)
encuestas_filtradas <- surveys_clean %>%
filter(size >= 500)
participacion_por_partido <- encuestas_filtradas %>%
group_by(Partido) %>%
summarise(mean_participacion = mean(value, na.rm = TRUE))
partidos_colores <- c(
"PSOE" = "#D50032",  # Color del PSOE (rojo)
"PP" = "#0056A0",    # Color del PP (azul)
"C's" = "#FF6600",    # Color de Ciudadanos (naranja)
"VOX" = "#006747",    # Color de VOX (verde)
"UP" = "#9B4F96",     # Color de Unidas Podemos (morado)
"ERC" = "#D82B6D",    # Color de ERC (rojo)
"PNV" = "#006A3E",    # Color del PNV (verde)
"MP" = "#03A9F4",     # Color de Más País (azul claro)
"EH-BILDU" = "#E32B5F",# Color de EH Bildu (rosa)
"CIU" = "#A7C3A4",    # Color de Convergencia i Unió (verde oliva)
"BNG" = "#E60012",    # Color del BNG (rojo)
"Otros" = "#BDBDBD"    # Color para otros partidos (gris)
)
# Crear los gofres
ggplot(participacion_por_partido, aes(fill = Partido, values = mean_participacion)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = partidos_colores) +
labs(title = "Participación Electoral Promedio por Partido (Tamaño de Muestra > 500)",
x = "Partido", y = "Participación Electoral Promedio (%)") +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Ángulo y tamaño de las etiquetas del eje X
axis.text.y = element_text(size = 12),  # Tamaño de las etiquetas del eje Y
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Título en negrita y centrado
) +
coord_flip()  # Esto voltea el gráfico para mejorar la legibilidad
encuestas_filtradas <- surveys_clean %>%
filter(size >= 500)
participacion_por_partido <- encuestas_filtradas %>%
group_by(Partido) %>%
summarise(mean_participacion = mean(value, na.rm = TRUE))
partidos_colores <- c(
"PSOE" = "#D50032",  # Color del PSOE (rojo)
"PP" = "#0056A0",    # Color del PP (azul)
"C's" = "#FF6600",    # Color de Ciudadanos (naranja)
"VOX" = "#006747",    # Color de VOX (verde)
"UP" = "#9B4F96",     # Color de Unidas Podemos (morado)
"ERC" = "#D82B6D",    # Color de ERC (rojo)
"PNV" = "#006A3E",    # Color del PNV (verde)
"MP" = "#03A9F4",     # Color de Más País (azul claro)
"EH-BILDU" = "#E32B5F",# Color de EH Bildu (rosa)
"CIU" = "#A7C3A4",    # Color de Convergencia i Unió (verde oliva)
"BNG" = "#E60012",    # Color del BNG (rojo)
"Otros" = "#BDBDBD"    # Color para otros partidos (gris)
)
# Crear los gofres
ggplot(participacion_por_partido, aes(fill = Partido, values = mean_participacion)) +
geom_col(stat = "identity") +
scale_fill_manual(values = partidos_colores) +
labs(title = "Participación Electoral Promedio por Partido (Tamaño de Muestra > 500)",
x = "Partido", y = "Participación Electoral Promedio (%)") +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Ángulo y tamaño de las etiquetas del eje X
axis.text.y = element_text(size = 12),  # Tamaño de las etiquetas del eje Y
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)  # Título en negrita y centrado
) +
coord_flip()  # Esto voltea el gráfico para mejorar la legibilidad
encuestas_filtradas <- surveys_clean |>
filter(size >= 500)
participacion_por_partido <- encuestas_filtradas |>
group_by(Partido) |>
summarise(mean_participacion = mean(value, na.rm = TRUE))
partidos_colores <- c(
"PSOE" = "#D50032",  # Color del PSOE (rojo)
"PP" = "#0056A0",    # Color del PP (azul)
"C's" = "#FF6600",    # Color de Ciudadanos (naranja)
"VOX" = "#006747",    # Color de VOX (verde)
"UP" = "#9B4F96",     # Color de Unidas Podemos (morado)
"ERC" = "#D82B6D",    # Color de ERC (rojo)
"PNV" = "#006A3E",    # Color del PNV (verde)
"MP" = "#03A9F4",     # Color de Más País (azul claro)
"EH-BILDU" = "#E32B5F",# Color de EH Bildu (rosa)
"CIU" = "#A7C3A4",    # Color de Convergencia i Unió (verde oliva)
"BNG" = "#E60012",    # Color del BNG (rojo)
"Otros" = "#BDBDBD"    # Color para otros partidos (gris)
)
# Crear los gofres
ggplot(participacion_por_partido, aes(x = reorder(Partido, -mean_participacion), y = mean_participacion, fill = Partido)) +
geom_bar(stat = "identity", width = 0.7) +  # Gráfico de barras
scale_fill_manual(values = partidos_colores) +  # Colores personalizados
labs(title = "Participación Electoral Promedio por Partido (Tamaño de Muestra > 500)",
x = "Partido", y = "Participación Electoral Promedio (%)") +
theme_minimal(base_size = 14) +  # Estilo minimalista
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Ángulo y tamaño de las etiquetas del eje X
axis.text.y = element_text(size = 12),  # Tamaño de las etiquetas del eje Y
plot.title = element_text(size = 18, face = "bold", hjust = 0.5),  # Título en negrita y centrado
legend.position = "none",  # Eliminar la leyenda
panel.grid.major.x = element_blank(),  # Eliminar las líneas de la cuadrícula en el eje X
panel.grid.minor.x = element_blank()   # Eliminar las líneas menores en el eje X
) +
coord_flip()  # Voltear el gráfico para mejorar la legibilidad
View(surveys_clean_siglas)
encuestas_filtradas <- surveys_clean_siglas |>
filter(size >= 500)
participacion_por_partido <- encuestas_filtradas |>
group_by(Partido) |>
summarise(mean_participacion = mean(value, na.rm = TRUE))
partidos_colores <- c(
"PSOE" = "#D50032",  # Color del PSOE (rojo)
"PP" = "#0056A0",    # Color del PP (azul)
"C's" = "#FF6600",    # Color de Ciudadanos (naranja)
"VOX" = "#006747",    # Color de VOX (verde)
"UP" = "#9B4F96",     # Color de Unidas Podemos (morado)
"ERC" = "#D82B6D",    # Color de ERC (rojo)
"PNV" = "#006A3E",    # Color del PNV (verde)
"MP" = "#03A9F4",     # Color de Más País (azul claro)
"EH-BILDU" = "#E32B5F",# Color de EH Bildu (rosa)
"CIU" = "#A7C3A4",    # Color de Convergencia i Unió (verde oliva)
"BNG" = "#E60012",    # Color del BNG (rojo)
"Otros" = "#BDBDBD"    # Color para otros partidos (gris)
)
# Crear los gofres
ggplot(participacion_por_partido, aes(x = reorder(Partido, -mean_participacion), y = mean_participacion, fill = Partido)) +
geom_bar(stat = "identity", width = 0.7) +  # Gráfico de barras
scale_fill_manual(values = partidos_colores) +  # Colores personalizados
labs(title = "Participación Electoral Promedio por Partido (Tamaño de Muestra > 500)",
x = "Partido", y = "Participación Electoral Promedio (%)") +
theme_minimal(base_size = 14) +  # Estilo minimalista
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Ángulo y tamaño de las etiquetas del eje X
axis.text.y = element_text(size = 12),  # Tamaño de las etiquetas del eje Y
plot.title = element_text(size = 18, face = "bold", hjust = 0.5),  # Título en negrita y centrado
legend.position = "none",  # Eliminar la leyenda
panel.grid.major.x = element_blank(),  # Eliminar las líneas de la cuadrícula en el eje X
panel.grid.minor.x = element_blank()   # Eliminar las líneas menores en el eje X
) +
coord_flip()  # Voltear el gráfico para mejorar la legibilidad
# Ejercicios extra Rodrigo:
# 1 ¿Qué comunidad autónoma tiene la mayor participación electoral promedio en las elecciones entre 2008 y 2019?
codigo_a_comunidad <- c(
"14" = "País Vasco",
"07" = "Castilla La Mancha",
"17" = "Comunidad Valenciana",
"01" = "Andalucía",
"08" = "Castilla y León",
"10" = "Extremadura",
"04" = "Islas Baleares",
"09" = "Cataluña",
"11" = "Galicia",
"02" = "Aragón",
"16" = "La Rioja",
"12" = "Madrid",
"15" = "Murcia",
"13" = "Navarra",
"03" = "Asturias",
"05" = "Canarias",
"06" = "Cantabria",
"18" = "Ceuta",
"19" = "Melilla"
)
# Calcular la participación promedio por comunidad autónoma
participacion_media_ccaa <- election_tidy_with_siglas |>
group_by(codigo_ccaa) |>
summarise(
participacion_promedio = mean(votos_candidaturas, na.rm = TRUE) / mean(censo, na.rm = TRUE) * 100
)
# Sustituir el código de la comunidad autónoma por su nombre usando el mapeo
participacion_media_ccaa <- participacion_media_ccaa |>
mutate(nombre_ccaa = codigo_a_comunidad[as.character(codigo_ccaa)])
# Mejorar gráfico con nombres de comunidad autónoma
ggplot(participacion_media_ccaa, aes(x = reorder(nombre_ccaa, -participacion_promedio), y = participacion_promedio, fill = nombre_ccaa)) +
geom_bar(stat = "identity", show.legend = FALSE, width = 0.8) +
geom_text(aes(label = round(participacion_promedio, 2)),
vjust = -0.3,  # Coloca los números a la derecha de las barras
color = "black", size = 3, fontface = "bold") +
scale_fill_viridis_d(option = "D", begin = 0.2, end = 0.8) +  # Colores agradables
scale_y_continuous(limits = c(0, 100)) +  # Ajustar el eje Y de 0 a 100
labs(
title = "Comunidad Autónoma con Mayor Participación Electoral Promedio (2008-2019)",
subtitle = "Participación promedio en las elecciones durante el período 2008-2019",
x = "Comunidad Autónoma",
y = "Participación Promedio (%)"
) +
theme_minimal(base_size = 15) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 13, family = "Arial", color = "darkblue"),
axis.text.y = element_text(size = 13, family = "Arial", color = "darkblue"),
axis.title.x = element_text(size = 14, face = "bold", family = "Arial", color = "darkred"),
axis.title.y = element_text(size = 14, face = "bold", family = "Arial", color = "darkred"),
plot.title = element_text(size = 11, face = "bold", family = "Arial", color = "darkgreen"),
plot.subtitle = element_text(size = 12, family = "Arial", color = "gray50"),
plot.margin = margin(10, 20, 10, 20),
panel.grid.major = element_line(color = "gray85", size = 0.5),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white", color = "white"))
# 2
encuestas_filtradas <- surveys_clean_siglas |>
filter(size >= 500)
participacion_por_partido <- encuestas_filtradas |>
group_by(Partido) |>
summarise(mean_participacion = mean(value, na.rm = TRUE))
partidos_colores <- c(
"PSOE" = "#D50032",  # Color del PSOE (rojo)
"PP" = "#0056A0",    # Color del PP (azul)
"C's" = "#FF6600",    # Color de Ciudadanos (naranja)
"VOX" = "#006747",    # Color de VOX (verde)
"UP" = "#9B4F96",     # Color de Unidas Podemos (morado)
"ERC" = "#D82B6D",    # Color de ERC (rojo)
"PNV" = "#006A3E",    # Color del PNV (verde)
"MP" = "#03A9F4",     # Color de Más País (azul claro)
"EH-BILDU" = "#E32B5F",# Color de EH Bildu (rosa)
"CIU" = "#A7C3A4",    # Color de Convergencia i Unió (verde oliva)
"BNG" = "#E60012",    # Color del BNG (rojo)
"Otros" = "#BDBDBD"    # Color para otros partidos (gris)
)
# Crear los gofres
ggplot(participacion_por_partido, aes(x = reorder(Partido, -mean_participacion), y = mean_participacion, fill = Partido)) +
geom_bar(stat = "identity", width = 0.7) +  # Gráfico de barras
scale_fill_manual(values = partidos_colores) +  # Colores personalizados
labs(title = "Participación Electoral Promedio por Partido (Tamaño de Muestra > 500)",
x = "Partido", y = "Participación Electoral Promedio (%)") +
theme_minimal(base_size = 14) +  # Estilo minimalista
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Ángulo y tamaño de las etiquetas del eje X
axis.text.y = element_text(size = 12),  # Tamaño de las etiquetas del eje Y
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),  # Título en negrita y centrado
legend.position = "none",  # Eliminar la leyenda
panel.grid.major.x = element_blank(),  # Eliminar las líneas de la cuadrícula en el eje X
panel.grid.minor.x = element_blank()   # Eliminar las líneas menores en el eje X
) +
coord_flip()  # Voltear el gráfico para mejorar la legibilidad
encuestas_filtradas <- surveys_clean_siglas |>
filter(size >= 500)
participacion_por_partido <- encuestas_filtradas |>
group_by(Partido) |>
summarise(mean_participacion = mean(value, na.rm = TRUE))
partidos_colores <- c(
"PSOE" = "#D50032",  # Color del PSOE (rojo)
"PP" = "#0056A0",    # Color del PP (azul)
"C's" = "#FF6600",    # Color de Ciudadanos (naranja)
"VOX" = "#006747",    # Color de VOX (verde)
"UP" = "#9B4F96",     # Color de Unidas Podemos (morado)
"ERC" = "#D82B6D",    # Color de ERC (rojo)
"PNV" = "#006A3E",    # Color del PNV (verde)
"MP" = "#03A9F4",     # Color de Más País (azul claro)
"EH-BILDU" = "#E32B5F",# Color de EH Bildu (rosa)
"CIU" = "#A7C3A4",    # Color de Convergencia i Unió (verde oliva)
"BNG" = "#E60012",    # Color del BNG (rojo)
"Otros" = "#BDBDBD"    # Color para otros partidos (gris)
)
# Crear los gofres
ggplot(participacion_por_partido, aes(x = reorder(Partido, -mean_participacion), y = mean_participacion, fill = Partido)) +
geom_bar(stat = "identity", width = 0.7) +  # Gráfico de barras
scale_fill_manual(values = partidos_colores) +  # Colores personalizados
labs(title = "Participación Electoral Promedio por Partido (Tamaño de Muestra > 500)",
x = "Partido", y = "Participación Electoral Promedio (%)") +
theme_minimal(base_size = 14) +  # Estilo minimalista
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Ángulo y tamaño de las etiquetas del eje X
axis.text.y = element_text(size = 12),  # Tamaño de las etiquetas del eje Y
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),  # Título en negrita y centrado
legend.position = "none",  # Eliminar la leyenda
panel.grid.major.x = element_blank(),  # Eliminar las líneas de la cuadrícula en el eje X
panel.grid.minor.x = element_blank()   # Eliminar las líneas menores en el eje X
) +
coord_flip()  # Voltear el gráfico para mejorar la legibilidad
# Ejercicios extra Rodrigo:
# 1 ¿Qué comunidad autónoma tiene la mayor participación electoral promedio en las elecciones entre 2008 y 2019?
codigo_a_comunidad <- c(
"14" = "País Vasco",
"07" = "Castilla La Mancha",
"17" = "Comunidad Valenciana",
"01" = "Andalucía",
"08" = "Castilla y León",
"10" = "Extremadura",
"04" = "Islas Baleares",
"09" = "Cataluña",
"11" = "Galicia",
"02" = "Aragón",
"16" = "La Rioja",
"12" = "Madrid",
"15" = "Murcia",
"13" = "Navarra",
"03" = "Asturias",
"05" = "Canarias",
"06" = "Cantabria",
"18" = "Ceuta",
"19" = "Melilla"
)
# Calcular la participación promedio por comunidad autónoma
participacion_media_ccaa <- election_tidy_with_siglas |>
group_by(codigo_ccaa) |>
summarise(
participacion_promedio = mean(votos_candidaturas, na.rm = TRUE) / mean(censo, na.rm = TRUE) * 100
)
# Sustituir el código de la comunidad autónoma por su nombre usando el mapeo
participacion_media_ccaa <- participacion_media_ccaa |>
mutate(nombre_ccaa = codigo_a_comunidad[as.character(codigo_ccaa)])
# Mejorar gráfico con nombres de comunidad autónoma
ggplot(participacion_media_ccaa, aes(x = reorder(nombre_ccaa, -participacion_promedio), y = participacion_promedio, fill = nombre_ccaa)) +
geom_bar(stat = "identity", show.legend = FALSE, width = 0.8) +
geom_text(aes(label = round(participacion_promedio, 2)),
vjust = -0.3,  # Coloca los números a la derecha de las barras
color = "black", size = 3, fontface = "bold") +
scale_fill_viridis_d(option = "D", begin = 0.2, end = 0.8) +  # Colores agradables
scale_y_continuous(limits = c(0, 100)) +  # Ajustar el eje Y de 0 a 100
labs(
title = "Comunidad Autónoma con Mayor Participación Electoral Promedio (2008-2019)",
subtitle = "Participación promedio en las elecciones durante el período 2008-2019",
x = "Comunidad Autónoma",
y = "Participación Promedio (%)"
) +
theme_minimal(base_size = 15) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 13, family = "Arial", color = "darkblue"),
axis.text.y = element_text(size = 13, family = "Arial", color = "darkblue"),
axis.title.x = element_text(size = 14, face = "bold", family = "Arial", color = "darkred"),
axis.title.y = element_text(size = 14, face = "bold", family = "Arial", color = "darkred"),
plot.title = element_text(size = 11, face = "bold", family = "Arial", color = "darkgreen"),
plot.subtitle = element_text(size = 12, family = "Arial", color = "gray50"),
plot.margin = margin(10, 20, 10, 20),
panel.grid.major = element_line(color = "gray85", size = 0.5),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white", color = "white"))
# 2
encuestas_filtradas <- surveys_clean_siglas |>
filter(size >= 500)
participacion_por_partido <- encuestas_filtradas |>
group_by(Partido) |>
summarise(mean_participacion = mean(value, na.rm = TRUE))
partidos_colores <- c(
"PSOE" = "#D50032",  # Color del PSOE (rojo)
"PP" = "#0056A0",    # Color del PP (azul)
"C's" = "#FF6600",    # Color de Ciudadanos (naranja)
"VOX" = "#006747",    # Color de VOX (verde)
"UP" = "#9B4F96",     # Color de Unidas Podemos (morado)
"ERC" = "#D82B6D",    # Color de ERC (rojo)
"PNV" = "#006A3E",    # Color del PNV (verde)
"MP" = "#03A9F4",     # Color de Más País (azul claro)
"EH-BILDU" = "#E32B5F",# Color de EH Bildu (rosa)
"CIU" = "#A7C3A4",    # Color de Convergencia i Unió (verde oliva)
"BNG" = "#E60012",    # Color del BNG (rojo)
"Otros" = "#BDBDBD"    # Color para otros partidos (gris)
>>>>>>> Stashed changes
)
# Crear los gofres
ggplot(participacion_por_partido, aes(x = reorder(Partido, -mean_participacion), y = mean_participacion, fill = Partido)) +
geom_bar(stat = "identity", width = 0.7) +  # Gráfico de barras
scale_fill_manual(values = partidos_colores) +  # Colores personalizados
labs(title = "Participación Electoral Promedio por Partido (Tamaño de Muestra > 500)",
x = "Partido", y = "Participación Electoral Promedio (%)") +
theme_minimal(base_size = 14) +  # Estilo minimalista
theme(
axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Ángulo y tamaño de las etiquetas del eje X
axis.text.y = element_text(size = 12),  # Tamaño de las etiquetas del eje Y
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),  # Título en negrita y centrado
legend.position = "none",  # Eliminar la leyenda
panel.grid.major.x = element_blank(),  # Eliminar las líneas de la cuadrícula en el eje X
panel.grid.minor.x = element_blank()   # Eliminar las líneas menores en el eje X
) +
coord_flip()  # Voltear el gráfico para mejorar la legibilidad
View(participacion_por_partido)
View(encuestas_filtradas)
